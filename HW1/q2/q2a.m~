%% Load Shepp-Logan Image and take Radon transform
clc;clear;clear all;
f = phantom(128);
figure
imshow(f)
theta = 0:3:177;
R = radon(f,theta);

%% Part a:

%%
% <html><h3>Ram-Lak filter</h3></html>
R_filtered = myFilter(R, 0.5,'Ram-Lak');
f_recon = backproj(R_filtered,theta);
figure
imshow(f_recon)

R_filtered = myFilter(R, 1,'Ram-Lak');
f_recon = backproj(R_filtered,theta);
figure
imshow(f_recon)
   
%%
% <html><h3>Shepp-Logan filter</h3></html>
R_filtered = myFilter(R, 0.5,'Shepp-Logan');
f_recon = backproj(R_filtered,theta);
figure
imshow(f_recon)

R_filtered = myFilter(R, 1,'Shepp-Logan');
f_recon = backproj(R_filtered,theta);
figure
imshow(f_recon)
    %% 
    % Observe that reconstructed image got smoother

%%
% <html><h3>Cosine filter</h3></html>
R_filtered = myFilter(R, 0.5,'Cosine');
f_recon = backproj(R_filtered,theta);
figure
imshow(f_recon)

R_filtered = myFilter(R, 1,'Cosine');
f_recon = backproj(R_filtered,theta);
figure
imshow(f_recon)
    %% 
    % Observe that reconstructed image got even smoother
    
%% Part b:
% Generate blurred images
mask = fspecial ('gaussian', 11, 1);
f1 = conv2 (image, mask, 'same');
mask = fspecial ('gaussian', 51, 5);
f5 = conv2 (image, mask, 'same');

%%
% Compute radon tranform
R0 = radon(f,theta);
R1 = radon(f1,theta);
R5 = radon(f5,theta);

%%
% Reconstruct using Ram-Lak filtered back projection
R_filtered0 = myFilter(R0, 1,'Ram-Lak');
R_filtered01 = myFilter(R0, 1,'Ram-Lak');
R_filtered0 = myFilter(R0, 1,'Ram-Lak');
f_recon0 = backproj(R_filtered0,theta);
f_recon0 = backproj(R_filtered0,theta);
f_recon0 = backproj(R_filtered0,theta);