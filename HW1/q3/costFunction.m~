function [J, grad] = costFunction(l, S, G)
%COSTFUNCTION Compute cost and gradient for Diffusion MRI optimization

L = [l(1) 0; l(3) l(2)];
J = 0;
for i = 1:size(G,2)
    g = G(:,i);
    J = J + (S(i) - exp(-0.1*g'*(L*L')*g))^2;
end

grad = 0;
for i = 1:size(G,2)
    g = G(:,i);
    d = [2*l(1)*g(1)^2 + 2*g(1)*g(2]
    grad = grad + (S(i) - exp(-0.1*g'*(L*L')*g))*(exp(-0.1*g'*(L*L')*g))*0.1*g'*(L*L')*g;
end


end